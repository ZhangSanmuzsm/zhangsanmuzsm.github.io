<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>Hexo blog 的升级与同步方案 - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/9.18.1/styles/github-gist.min.css" />


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_fmb4a04yx8h.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_ijqayz9ro8k.css">




<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


<meta name="generator" content="Hexo 4.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Hexo</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="iconfont icon-home-fill"></i>
              首页</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">
              <i class="iconfont icon-archive-fill"></i>
              归档</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">
              <i class="iconfont icon-category-fill"></i>
              分类</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">
              <i class="iconfont icon-tags-fill"></i>
              标签</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">
              <i class="iconfont icon-user-fill"></i>
              关于</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <div class="mt-3 post-meta">
                  <i class="iconfont icon-date-fill" aria-hidden="true"></i>
                  <time datetime="2020-01-18 23:31">
                    星期六, 一月 18日 2020, 11:31 晚上
                  </time>
                </div>
              

              <div class="mt-1">
                
                  
                  <span class="post-meta mr-2">
                    <i class="iconfont icon-chart"></i>
                    1.4k 字
                  </span>
                

                
                  
                  <span class="post-meta mr-2">
                      <i class="iconfont icon-clock-fill"></i>
                    
                    
                    17
                     分钟
                  </span>
                

                
              </div>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>个人觉得 Hexo 框架及 Next 主题搭建博客还算比较方便，关于如何使用 Hexo 框架及 Next 主题搭建博客，我们可以在 Hexo 官方网站和 Github 上 Next 主题官方仓库上找到比较详细的教程。本文主要介绍一种 Hexo blog 的升级与同步方案，该方案来自大神 <code>anran758</code>, 该方案可以解决在多设备中频繁切换以及升级 Next 主题的需要。</p>
<h1 id="Hexo-blog-的升级与同步方案"><a href="#Hexo-blog-的升级与同步方案" class="headerlink" title="Hexo blog 的升级与同步方案"></a>Hexo blog 的升级与同步方案</h1><h2 id="具体流程"><a href="#具体流程" class="headerlink" title="具体流程"></a>具体流程</h2><ol>
<li><p>创建一个私人（之所以用私人仓库是因为可能会包含个人的某些应用的 <code>appid</code> 或者 <code>secret</code> 等，下同）仓库用于托管博客（站点）。</p>
 <pre><code class="hljs bash"><span class="hljs-comment"># 初始化 git 项目    </span>
git init

<span class="hljs-comment"># 添加一个名为 origin 的 remote    </span>
<span class="hljs-comment"># your_repo_path 是你创建仓库得到的仓库地址   </span>
git remote add origin your_repo_path

<span class="hljs-comment"># 提交代码    </span>
git add .    
git commit -m <span class="hljs-string">"new: blog 数据开始进行版本控制"</span>

<span class="hljs-comment"># 设置上游 (-u) 并推送至远程的 master 分支    </span>
git push -u origin master</code></pre>
</li>
<li><p>克隆 Next 主题仓库，此时本地 git 仓库会有一个远程分支 <code>Origin/Master</code>, 该分支保留着用于更新（克隆）Next 主题仓库，使用 <code>git checkout -B customize</code> 创建另一个 <code>customize</code> 分支，该分支用于 push 推送到一个新的私人仓库用于管理备份自己的 Next 主题（此时包含了所有个人修改）。</p>
 <pre><code class="hljs bash"><span class="hljs-comment"># 进入站点根目录</span>
<span class="hljs-built_in">cd</span> blog
git <span class="hljs-built_in">clone</span> https://github.com/theme-next/hexo-theme-next themes/next

<span class="hljs-comment"># 创建并切换新分支</span>
git checkout -B customize
<span class="hljs-comment"># 进行主题配置或其他修改操作</span>

<span class="hljs-comment"># 提交改动 (未推送)</span>
git add .
git commit -m <span class="hljs-string">"chg: 修改为自定义配置"</span>
<span class="hljs-comment"># 添加一个名为 userRepo (名字可以自己定义，只要自己能搞清是哪个来源即可) 的新 remote，</span>
git remote add userRepo git@github.com:anran758/hexo-xxx-next.git

<span class="hljs-comment"># 设置上游 (即以后使用 git pull/status 时默认拉取 userRepo 源的 customize 分支)，并推送指定 remote</span>
git push -u userRepo customize

<span class="hljs-comment"># 升级 Next 版本</span>
<span class="hljs-comment"># 从 origin/master 获取最新版本的代码</span>
<span class="hljs-comment"># 理论上我们不修改 master 分支的代码不会发生冲突</span>
<span class="hljs-comment"># 切换至 customize 分支</span>
git checkout customize
git fetch origin --tags
git merge --allow-unrelated-histories origin/master</code></pre></li>
<li><p>创建名为 <code>Username.github.io</code> 的仓库，其中 <code>Username</code> 替换为自己的 Github 用户名，此仓库用于存放 Hexo 部署的网页。</p>
</li>
<li><p>重做系统或者更换电脑后，按如下流程操作来接管之前管理的博客，可以将下面的命令保存为 <code>recover.sh</code>, 然后直接执行该脚本文件，一次性还原并升级 <code>next</code> 主题。</p>
<pre><code class="hljs bash"><span class="hljs-comment">##########准备工作##########</span>
<span class="hljs-comment"># 执行脚本之前先安装好 git 和 node.js！！！</span>
<span class="hljs-comment"># 进入站点目录所在目录</span>
<span class="hljs-built_in">cd</span> D:/Blog
<span class="hljs-comment"># 安装 hexo 命令行工具</span>
npm install -g hexo-cli


<span class="hljs-comment">##########克隆自己的站点和主题仓库##########</span>
<span class="hljs-comment"># 克隆自己的站点仓库</span>
git <span class="hljs-built_in">clone</span> git@github.com:GitAndGithub/hexo.git
<span class="hljs-comment"># 进入主题目录</span>
<span class="hljs-built_in">cd</span> hexo/themes/
<span class="hljs-comment"># 克隆自己的主题仓库</span>
git <span class="hljs-built_in">clone</span> -o hexo-theme-next git@github.com:GitAndGithub/hexo-theme-next.git
<span class="hljs-comment"># 重命名主题文件夹</span>
mv hexo-theme-next next
<span class="hljs-comment"># 进入 next 主题文件夹</span>
<span class="hljs-built_in">cd</span> next/


<span class="hljs-comment">##########添加远程 next 主题仓库并合并到自己的 next 主题仓库实现主题升级##########</span>
<span class="hljs-comment"># 添加远程 next 主题仓库，名为 origin</span>
git remote add origin git@github.com:theme-next/hexo-theme-next.git
<span class="hljs-comment"># git fetch 从远程分支拉取代码</span>
<span class="hljs-comment"># fetch 常结合 merge 一起用，git fetch + git merge == git pull</span>
<span class="hljs-comment"># 一般要用 git fetch + git merge, 因为 git pull 会将代码直接合并，造成冲突等无法知道</span>
<span class="hljs-comment"># fetch 代码下来一般要 git diff orgin/xx 来看一下差异然后再合并，我这里忽略了此步骤</span>
git fetch origin --tags
git merge --allow-unrelated-histories origin/master
<span class="hljs-comment"># 如有冲突自行修改主题配置文件解决冲突后再 merge</span>


<span class="hljs-comment">##########安装和卸载相应依赖##########</span>
<span class="hljs-comment"># 回到站点目录</span>
<span class="hljs-built_in">cd</span> D:/Blog/hexo
<span class="hljs-comment"># 安装 package.json 中指明的依赖</span>
npm install
<span class="hljs-comment"># 安装其他自己所用到的依赖以及卸载掉不用的其他依赖</span>
npm install hexo-deployer-git
npm un hexo-renderer-marked
npm i hexo-renderer-kramed


<span class="hljs-comment">##########保证数学公式渲染需要的更改##########</span>
<span class="hljs-comment"># 保证博客中 mathjax 数学公式渲染正确，需要修改 kramed 渲染的 inline.js 中相应规则</span>
sed -i <span class="hljs-string">'11s/^.*$/e\scape: \/\^\\\\(\[\`\*\\\[\\\]\(\)\#\$+\\-.!_&gt;\]\)\/,/'</span> ./node_modules/kramed/lib/rules/inline.js
sed -i <span class="hljs-string">'20s/^.*$/em: \/\^\\\*\(\(?:\\\*\\\*\|\[\\\s\\S\]\)+?\)\\\*\(?!\\\*\)\/,/'</span> ./node_modules/kramed/lib/rules/inline.js


<span class="hljs-comment">##########清理、生成和部署博客##########</span>
<span class="hljs-comment"># 清理、生成和部署博客</span>
hexo clean &amp;&amp; hexo g -d</code></pre>
<p>以后更新博客之后依然记得对博客进行如下的版本控制即可，同样地，可以将如下命令保存为 <code>deploy.sh</code>, 以后直接执行该文件实现一键部署。</p>
<pre><code class="hljs bash"><span class="hljs-built_in">cd</span> D:/Blog/hexo
hexo clean &amp;&amp; hexo g -d
git add .
git commit -m <span class="hljs-string">"Update: 更新站点配置"</span>
git push origin master

<span class="hljs-built_in">cd</span> themes/next
git add .
git commit -m <span class="hljs-string">"Update: 更新next主题配置"</span>
git push hexo-theme-next customize</code></pre>

</li>
</ol>
<h2 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h2><ul>
<li>在第 1 步中由于 <code>/theme/next</code> 本身也是一个仓库，git 无法提交嵌套仓库的文件夹，因此需要在 <code>.gitignore</code> 添加配置，忽略该文件夹。  <pre><code class="hljs bash"><span class="hljs-comment"># 其他忽略规则...</span>

themes/next/</code></pre></li>
<li>在第 2 步中可以去 Next 主题官方 Github 仓库 Watch Release 或者在主题配置文件中设置 <code>reminder: true</code> 以便得知最新 Release 版本号，便于及时更新，其中设置 <code>reminder: true</code> 的方法会在每次部署 <code>hexo d</code> 或者本地服务器预览 <code>hexo s</code> 时提示是否是最新版本。更新时如有冲突，可能需要自行手动调整修改配置文件。</li>
</ul>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ol>
<li><a href="https://zhuanlan.zhihu.com/p/89803184" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/89803184</a></li>
<li><a href="https://anran758.github.io/blog/2019/11/02/hexo-blog-upgrade-and-version-control/" target="_blank" rel="noopener">https://anran758.github.io/blog/2019/11/02/hexo-blog-upgrade-and-version-control/</a></li>
</ol>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Hexo/">Hexo</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Hexo/">Hexo</a>
                    
                      <a class="hover-with-bg" href="/tags/Blog/">Blog</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/01/28/matlab-%E4%B8%AD%E5%B0%86-gui-%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8C%85%E6%88%90%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">matlab 中 gui 程序打包成可执行文件</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>






<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Hexo blog 的升级与同步方案&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>


















</body>
</html>
